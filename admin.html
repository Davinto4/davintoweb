<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Page</title>
  <link rel="stylesheet" href="style.css">
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, onChildAdded } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBz7fdasuQLxIFLq2TJzPAQrDTJq6h_YT8",
      authDomain: "davintoweb-payments.firebaseapp.com",
      databaseURL: "https://davintoweb-payments-default-rtdb.firebaseio.com",
      projectId: "davintoweb-payments",
      storageBucket: "davintoweb-payments.appspot.com",
      messagingSenderId: "667742200333",
      appId: "1:667742200333:web:cf75f6cef6798eed432b44"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const confirmRef = ref(db, "confirmations");

    const tableBody = document.getElementById("confirmation-table-body");

    onChildAdded(confirmRef, (snapshot) => {
      const data = snapshot.val();
      const row = document.createElement("tr");
      row.innerHTML = `
        <td>${data.accountName}</td>
        <td>${data.bankName}</td>
        <td>${data.accountNumber}</td>
        <td>${data.phone}</td>
        <td>${data.email}</td>
        <td>${data.message}</td>
        <td>${new Date(data.timestamp).toLocaleString() || ''}</td>
      `;
      tableBody.appendChild(row);
    });
  </script>
</head>
<body>
  <div id="loginScreen">
    <h2>üîê Admin Login</h2>
    <input type="password" id="adminPass" placeholder="Enter password" />
    <button onclick="unlock()">Unlock</button>
  </div>

  <div id="adminPanel" style="display:none">
    <header>
      <h1>Admin Page</h1>
      <button onclick="logout()">Logout</button>
      <a href="confirm.html" class="btn">Go to Confirmation Form</a>
    </header>

    <section>
      <h2>‚úÖ Payment Confirmations</h2>
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Account Name</th>
              <th>Bank Name</th>
              <th>Account Number</th>
              <th>Phone</th>
              <th>Email</th>
              <th>Message</th>
              <th>Timestamp</th>
            </tr>
          </thead>
          <tbody id="confirmation-table-body"></tbody>
        </table>
      </div>
    </section>
  </div>

  <!-- SmartUpp Live Chat -->
  <script type="text/javascript">
    var _smartsupp = _smartsupp || {};
    _smartsupp.key = '0d074f1a6588d3c0562657b1e5a3dd332cf9af81';
    window.smartsupp||(function(d) {
      var s,c,o=smartsupp=function(){ o._.push(arguments) };o._=[];
      s=d.getElementsByTagName('script')[0];c=d.createElement('script');
      c.type='text/javascript';c.charset='utf-8';c.async=true;
      c.src='https://www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
    })(document);
  </script>

  <script>
    const PASSWORD = "08022664487@Mac";
    function unlock() {
      const input = document.getElementById("adminPass").value;
      if (input === PASSWORD) {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
      } else {
        alert("Incorrect password.");
      }
    }
    function logout() {
      document.getElementById("adminPanel").style.display = "none";
      document.getElementById("loginScreen").style.display = "block";
      document.getElementById("adminPass").value = "";
    }
  </script>
</body>
</html>